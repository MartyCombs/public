#=============================================================================#
# PostgreSQL
## OS X
 * User: marty
 * Database: purpleair
 * Start: 'brew services start postgresql@16'

## Ubuntu
  * User: postgres
  * Database: purpleair

#=============================================================================#
# ChatGPT examples
# Create table with event_time as a unique timestamp.
CREATE TABLE purple_air_1 (
    id SERIAL PRIMARY KEY,
    event_time TIMESTAMP WITH TIME ZONE UNIQUE NOT NULL
);

# Insert a sample epoch time (convert Unix epoch seconds to TIMESTAMP WITH TIME ZONE)
INSERT INTO purple_air_1 (event_time)
VALUES (TO_TIMESTAMP(1672531200) AT TIME ZONE 'UTC');

# Query the table
SELECT * FROM purple_air_1;

# Insert values into table ignoring any duplicate timestamps as they
# should have already been inserted.

INSERT INTO purple_air_1 (event_time)
VALUES (TO_TIMESTAMP(1672531200) AT TIME ZONE 'UTC')
ON CONFLICT (event_time) DO NOTHING;

#=============================================================================#

CREATE TABLE purple_air_1 (
    id                 SERIAL PRIMARY KEY,
    event_time         TIMESTAMP WITH TIME ZONE UNIQUE NOT NULL,
    sensor_response    JSONB
);

#=============================================================================#
CREATE USER purple WITH PASSWORD 'your_secure_password';
GRANT CONNECT ON DATABASE purple_db TO purple;
GRANT USAGE ON SCHEMA public TO purple;
GRANT SELECT, INSERT, UPDATE, DELETE ON ALL TABLES IN SCHEMA public TO purple;
ALTER DEFAULT PRIVILEGES IN SCHEMA public GRANT SELECT, INSERT, UPDATE, DELETE ON TABLES TO purple;

